<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ç¾è¥¿èˆŠé‡‘å±±èˆ‡æ´›æ‰ç£¯ä¹‹æ—…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Chosen Palette: Earthy Calm */
    :root {
        /* å¥¶æ²¹ç³»åŸºåº• */
        --bg-warm: #fbf7f2;          /* å¥¶æ²¹ç™½èƒŒæ™¯ */
        --card-bg: #ffffff;
        --border-soft: #efe6d8;

        /* æ–‡å­— */
        --text-primary: #3a3a3a;
        --text-secondary: #6b6b6b;

        /* ä¸»è¦–è¦ºå¼·èª¿è‰²ï¼ˆåªç•™ä¸€çµ„ï¼‰ */
        --accent-main: #d6b98c;      /* å¥¶èŒ¶é‡‘ */
        --accent-main-dark: #c3a36f;

        /* è¼”åŠ©è‰²ï¼ˆä½å½©åº¦ï¼‰ */
        --accent-soft-blue: #cfdde6;
        --accent-soft-green: #d9e5d8;
        }
    body {
        background-color: var(--bg-warm);
        color: var(--text-primary);
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .tab-active {
            border-bottom: 2px solid var(--accent-gold);
            color: #d69e2e;
            font-weight: bold;
        }
        .card-hover {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* Custom Scrollbar for itinerary list */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 3px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }
        /* Style for the clickable attraction name in itinerary */
        .attraction-link {
            transition: color 0.1s;
        }
        /* Keyframe for a subtle fade-in effect on itinerary change */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        /* ---------- 3-Day Weather (MUJI Style) ---------- */
        
        .weather-card {
            background-color: #faf7f2;
            border: 1px solid var(--border-soft);
            border-radius: 1rem;
            padding: 0.75rem 1rem;
            text-align: center;
            min-width: 90px;
        }
        
        .weather-icon {
            font-size: 1.4rem;
            margin-bottom: 0.25rem;
        }
        
        .weather-date {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-bottom: 0.25rem;
        }
        
        .weather-temp {
            font-size: 0.9rem;
            font-weight: 500;
        }
        /* ---------- Fix Weather Layout Overflow ---------- */
        
        #weather-3day .flex {
            flex-wrap: wrap;          /* å…è¨±æ›è¡Œ */
            justify-content: flex-start;
        }
        
        .weather-card {
            flex: 1 1 calc(33.333% - 0.75rem);  /* æ¡Œæ©Ÿä¸‰ç­‰åˆ† */
            min-width: 80px;          /* é™ä½æœ€å°å¯¬ */
            max-width: 100%;
        }
        
        /* æ‰‹æ©Ÿå„ªåŒ– */
        @media (max-width: 640px) {
            .weather-card {
                flex: 1 1 calc(50% - 0.75rem);  /* å…©å¼µä¸€æ’ */
            }
        }

    </style>
    <!-- Application Structure Plan:
         1. Hero Section: Title, Dates, and high-level trip stats (Days, Cities).
         2. Navigation: Simple sticky sub-nav to jump between Logistics, Itinerary, and Highlights.
         3. Logistics Hub: Interactive section for Flights (toggle View) and Essential Info (Cards). Includes a Weather Comparison Chart (Chart.js) to visualize clothing needs. NOW includes a 13-Day Daily Forecast and Accommodation Summary.
         4. The Journey (Itinerary): A split-view interactive timeline. Left side lists the 3 major phases (SF, PCH, LA). Clicking a phase reveals detailed day-by-day activities on the right. (Daily itinerary includes Attraction Details.)
         5. Destination Discovery (Attractions): A filterable grid of attraction cards.
         6. Footer: Simple closing.
    -->
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Hero Section -->
    <header class="bg-white shadow-sm border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center">
            <h1 class="text-4xl font-extrabold tracking-tight text-gray-900 sm:text-5xl mb-2">
                2026 ç¾è¥¿èˆŠé‡‘å±±èˆ‡æ´›æ‰ç£¯ä¹‹æ—…
            </h1>
            <p class="text-lg text-gray-600 mb-6">
                2æœˆ26æ—¥ - 3æœˆ11æ—¥ Â· 13 å¤© 12 å¤œ Â· åŠ å·å¤¢å¹»è¡Œ
            </p>
            <!-- å¯é»æ“Šçš„å°èˆªæŒ‰éˆ• (å·²é€£çµè‡³å¤–éƒ¨ç¶²ç«™) -->
            <!-- èª¿æ•´ space-x ä»¥é©æ‡‰æ›´å¤šé …ç›® -->
            <div class="flex flex-wrap justify-center space-x-4 md:space-x-8 text-sm font-medium text-gray-500">
                <a href="https://www.sftravel.com/" target="_blank" class="flex flex-col items-center hover:text-blue-600 hover:scale-110 transition-all cursor-pointer" title="å‰å¾€èˆŠé‡‘å±±æ—…éŠå±€å®˜ç¶²">
                    <span class="text-2xl mb-1">ğŸŒ‰</span>
                    <span>èˆŠé‡‘å±±</span>
                </a>
                <a href="https://www.nps.gov/yose/index.htm" target="_blank" class="flex flex-col items-center hover:text-green-600 hover:scale-110 transition-all cursor-pointer" title="å‰å¾€å„ªå‹ç¾åœ°åœ‹å®¶å…¬åœ’å®˜ç¶²">
                    <span class="text-2xl mb-1">ğŸŒ²</span>
                    <span>å„ªå‹ç¾åœ°</span>
                </a>
                <a href="https://www.visitcalifornia.com/road-trips/highway-one-classic/" target="_blank" class="flex flex-col items-center hover:text-yellow-600 hover:scale-110 transition-all cursor-pointer" title="å‰å¾€åŠ å·æ—…éŠå±€-ä¸€è™Ÿå…¬è·¯ä»‹ç´¹">
                    <span class="text-2xl mb-1">ğŸš—</span>
                    <span>ä¸€è™Ÿå…¬è·¯</span>
                </a>
                <a href="https://www.discoverlosangeles.com/" target="_blank" class="flex flex-col items-center hover:text-purple-600 hover:scale-110 transition-all cursor-pointer" title="å‰å¾€æ´›æ‰ç£¯æ—…éŠå±€å®˜ç¶²">
                    <span class="text-2xl mb-1">ğŸ¬</span>
                    <span>æ´›æ‰ç£¯</span>
                </a>
                <!-- æ–°å¢ï¼šè¿ªå£«å°¼æ¨‚åœ’ -->
                <a href="disneyland_itinerary.html" target="_blank" class="flex flex-col items-center hover:text-red-600 hover:scale-110 transition-all cursor-pointer" title="å‰å¾€è¿ªå£«å°¼æ¨‚åœ’å®˜ç¶²">
                    <span class="text-2xl mb-1">ğŸ°</span>
                    <span>è¿ªå£«å°¼æ¨‚åœ’</span>
                </a>
                <!-- æ–°å¢ï¼šç’°çƒå½±åŸ -->
                <a href="universal_hollywood.html" target="_blank" class="flex flex-col items-center hover:text-orange-600 hover:scale-110 transition-all cursor-pointer" title="å‰å¾€ç’°çƒå½±åŸå®˜ç¶²">
                    <span class="text-2xl mb-1">ğŸ¥</span>
                    <span>ç’°çƒå½±åŸ</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/95 backdrop-blur shadow-sm">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-center space-x-8 h-12 items-center">
                <button onclick="scrollToSection('logistics')" class="text-gray-600 hover:text-yellow-600 px-3 py-2 text-sm font-medium transition-colors">è¡Œå‰æº–å‚™ & èˆªç­</button>
                <button onclick="scrollToSection('itinerary')" class="text-gray-600 hover:text-yellow-600 px-3 py-2 text-sm font-medium transition-colors">æ¯æ—¥è¡Œç¨‹</button>
                <button onclick="scrollToSection('highlights')" class="text-gray-600 hover:text-yellow-600 px-3 py-2 text-sm font-medium transition-colors">æ™¯é»æ¢ç´¢</button>
            </div>
        </div>
    </nav>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full space-y-16">

        <!-- Section 1: Logistics Hub -->
        <section id="logistics" class="scroll-mt-20">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900">ğŸ›« è¡Œå‰æº–å‚™èˆ‡è³‡è¨Š</h2>
                <p class="mt-2 text-gray-600 max-w-2xl mx-auto">
                    åŒ…å«èˆªç­æ™‚é–“ã€å¿…å‚™æ–‡ä»¶æª¢æŸ¥ã€ä»¥åŠç•¶åœ°å¤©æ°£é æ¸¬ï¼Œå”åŠ©æ‚¨æ‰“åŒ…è¡Œæèˆ‡è¦åŠƒæŠµé”äº‹å®œã€‚
                </p>
            </div>
 
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Flight Info -->
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">âœˆï¸ èˆªç­è³‡è¨Š</h3>
                        <div class="flex space-x-2 bg-gray-100 rounded-lg p-1">
                            <button onclick="switchFlightTab('outbound')" id="btn-outbound" class="px-3 py-1 rounded-md text-sm font-medium transition-colors bg-white shadow text-gray-900">å»ç¨‹</button>
                            <button onclick="switchFlightTab('inbound')" id="btn-inbound" class="px-3 py-1 rounded-md text-sm font-medium transition-colors text-gray-500 hover:text-gray-900">å›ç¨‹</button>
                        </div>
                    </div>
                    
                    <div id="flight-content" class="space-y-4">
                        <!-- Dynamic Content Loaded via JS -->
                    </div>
                </div>
            
                <!-- Weather & Tips -->
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 flex flex-col">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸŒ¡ï¸ æ°£æº«è¶¨å‹¢èˆ‡ç©¿è‘—å»ºè­°</h3>
                    <div class="flex-grow flex flex-col justify-center">
                        <div class="chart-container mb-4">
                            <canvas id="weatherChart"></canvas>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg text-sm text-yellow-800 border border-yellow-100">
                            <strong>ğŸ’¡ ç©¿æ­ç­†è¨˜ï¼š</strong> èˆŠé‡‘å±±æº«å·®å¤§ä¸”å¤šé¢¨ï¼Œå»ºè­°ã€Œæ´‹è”¥å¼ç©¿æ³•ã€ä¸¦æ”œå¸¶é˜²é¢¨å¤–å¥—ï¼›æ´›æ‰ç£¯ç™½å¤©æº«æš–ï¼Œå¯æº–å‚™è–„é•·è¢–ã€‚
                        </div>
                    </div>
                </div>
                <!-- 3-Day Weather Forecast -->
                <section id="weather-3day" class="mt-12">
                  <h3 class="text-2xl font-semibold text-center mb-6">
                    ğŸ“ æ‰€åœ¨åœ°å€ãƒ»æœªä¾† 3 å¤©å¤©æ°£
                  </h3>

                  <div class="grid md:grid-cols-3 gap-6">
                <!-- Current Location -->
                  <div class="bg-white rounded-2xl p-6 shadow-lg border">
                  <h4 class="text-lg font-medium mb-1">ç›®å‰æ‰€åœ¨åœ°</h4>
                  <p class="text-sm text-gray-500 mb-4" id="current-city">å®šä½ä¸­â€¦</p>
                  <div id="weather-current" class="flex gap-4"></div>
                  <p id="wear-current" class="text-sm text-gray-600 mt-3"></p>
    </div>

                <!-- San Francisco -->
                  <div class="bg-white rounded-2xl p-6 shadow-lg border">
                  <h4 class="text-lg font-medium mb-1">èˆŠé‡‘å±±</h4>
                  <p class="text-sm text-gray-500 mb-4">San Francisco</p>
                  <div id="weather-sf" class="flex gap-4"></div>
                  <p id="wear-sf" class="text-sm text-gray-600 mt-3"></p>
    </div>

                <!-- Los Angeles -->
                  <div class="bg-white rounded-2xl p-6 shadow-lg border">
                  <h4 class="text-lg font-medium mb-1">æ´›æ‰ç£¯</h4>
                  <p class="text-sm text-gray-500 mb-4">Los Angeles</p>
                  <div id="weather-la" class="flex gap-4"></div>
                  <p id="wear-la" class="text-sm text-gray-600 mt-3"></p>
     </div>
  </div>
</section>
            </div>

            <!-- ACCOMMODATION SUMMARY -->
            <div class="mt-8 bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="mr-2 text-2xl">ğŸ¨</span> ä½å®¿è¦åŠƒ
                </h3>
                <div id="accommodation-content" class="space-y-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Dynamic Content Loaded via JS -->
                </div>
            </div>
            
            <!-- Essential Checklist Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-8">
                <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                    <div class="text-2xl mb-2">ğŸ“„</div>
                    <h4 class="font-bold text-blue-900">è­‰ä»¶æª¢æŸ¥</h4>
                    <p class="text-sm text-blue-800 mt-1">è­·ç…§ã€ESTAã€åœ‹éš›é§•ç…§ã€å°ç£é§•ç…§æ­£æœ¬ã€‚</p>
                </div>
                <div class="bg-green-50 p-4 rounded-xl border border-green-100">
                    <div class="text-2xl mb-2">ğŸ’µ</div>
                    <h4 class="font-bold text-green-900">è²¨å¹£å°è²»</h4>
                    <p class="text-sm text-green-800 mt-1">ä½¿ç”¨ USDã€‚é¤å»³å°è²»ç´„ 15-20%ã€‚æ¨™åƒ¹ä¸å«ç¨…ã€‚</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-xl border border-purple-100">
                    <div class="text-2xl mb-2">ğŸ“±</div>
                    <h4 class="font-bold text-purple-900">ç¶²è·¯é€šè¨Š</h4>
                    <p class="text-sm text-purple-800 mt-1">æå‰è³¼è²· SIM å¡æˆ–ç§Ÿå€Ÿ Wi-Fi æ©Ÿã€‚æ™‚å€æ…¢ 16 å°æ™‚ã€‚</p>
                </div>
                <div class="bg-red-50 p-4 rounded-xl border border-red-100">
                    <div class="text-2xl mb-2">ğŸš—</div>
                    <h4 class="font-bold text-red-900">äº¤é€šé ˆçŸ¥</h4>
                    <p class="text-sm text-red-800 mt-1">SFæ­å¤§çœ¾é‹è¼¸ï¼›LAæ­Uberï¼›PCHè‡ªé§•å‰æŸ¥è·¯æ³ã€‚</p>
                </div>
            </div>


        </section>

        <!-- Section 2: Itinerary -->
        <section id="itinerary" class="scroll-mt-20">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900">ğŸ—ºï¸ 13 å¤©æ—…ç¨‹è¦åŠƒ</h2>
                <p class="mt-2 text-gray-600 max-w-2xl mx-auto">
                    è¡Œç¨‹åˆ†ç‚ºä¸‰å¤§ä¸»é¡Œéšæ®µã€‚é»é¸å·¦å´éšæ®µå¯æŸ¥çœ‹æ¯æ—¥è©³ç´°å®‰æ’èˆ‡**ç›¸é—œæ™¯é»äº®é»**ã€‚
                </p>
            </div>

            <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100 flex flex-col md:flex-row h-[600px]">
                <!-- Sidebar: Phases -->
                <div class="w-full md:w-1/3 bg-gray-50 border-r border-gray-200 overflow-y-auto custom-scroll">
                    <div class="p-4 space-y-2">
                        <button onclick="renderItinerary('phase1')" id="nav-phase1" class="w-full text-left p-4 rounded-xl transition-all border-l-4 border-blue-500 bg-white shadow-sm hover:bg-blue-50 group">
                            <div class="text-xs font-bold text-blue-500 uppercase tracking-wider mb-1">Phase 1 Â· 2/26 - 3/2</div>
                            <h3 class="text-lg font-bold text-gray-900 group-hover:text-blue-700">ä¸‰è—©å¸‚æ¼«éŠèˆ‡NBA</h3>
                            <p class="text-sm text-gray-500 mt-1">é‡‘é–€å¤§æ©‹ã€æƒ¡é­”å³¶ã€NBA è³½äº‹</p>
                        </button>

                        <button onclick="renderItinerary('phase2')" id="nav-phase2" class="w-full text-left p-4 rounded-xl transition-all border-l-4 border-transparent hover:border-yellow-500 hover:bg-yellow-50 group">
                            <div class="text-xs font-bold text-yellow-600 uppercase tracking-wider mb-1">Phase 2 Â· 3/3 - 3/5</div>
                            <h3 class="text-lg font-bold text-gray-900 group-hover:text-yellow-700">åŠ å·ä¸€è™Ÿå…¬è·¯</h3>
                            <p class="text-sm text-gray-500 mt-1">çµ•ç¾æµ·å²¸è‡ªé§•ã€èµ«æ°å¤å ¡</p>
                        </button>

                        <button onclick="renderItinerary('phase3')" id="nav-phase3" class="w-full text-left p-4 rounded-xl transition-all border-l-4 border-transparent hover:border-purple-500 hover:bg-purple-50 group">
                            <div class="text-xs font-bold text-purple-500 uppercase tracking-wider mb-1">Phase 3 Â· 3/6 - 3/9</div>
                            <h3 class="text-lg font-bold text-gray-900 group-hover:text-purple-700">å¤©ä½¿ä¹‹åŸèˆ‡é›™æ¨‚åœ’</h3>
                            <p class="text-sm text-gray-500 mt-1">è¿ªå£«å°¼ã€ç’°çƒå½±åŸã€æ˜Ÿå…‰å¤§é“</p>
                        </button>
                    </div>
                </div>

                <!-- Content: Daily Details -->
                <div class="w-full md:w-2/3 p-6 md:p-8 overflow-y-auto custom-scroll bg-white relative">
                    <div id="itinerary-details" class="space-y-8">
                        <!-- Content injected via JS -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Highlights -->
        <section id="highlights" class="scroll-mt-20">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900">ğŸ›ï¸ ç²¾é¸æ™¯é»æ¢ç´¢</h2>
                <p class="mt-2 text-gray-600 max-w-2xl mx-auto">
                    æ¢ç´¢æœ¬æ¬¡æ—…ç¨‹çš„å¿…è¨ªäº®é»ã€‚**é»æ“Šä¸‹æ–¹æ™¯é»å¡ç‰‡å³å¯å‰å¾€å®˜æ–¹ç¶²ç«™ã€‚**
                </p>
            </div>

            <!-- Filters: Added Yosemite Button -->
            <div class="flex flex-wrap justify-center gap-2 mb-8">
                <button onclick="filterAttractions('all')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-gray-800 text-white shadow-md hover:bg-gray-700 transition-colors active-filter" data-filter="all">å…¨éƒ¨é¡¯ç¤º</button>
                <button onclick="filterAttractions('SF')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-white text-gray-600 border border-gray-200 hover:bg-blue-50 hover:text-blue-600 transition-colors" data-filter="SF">ğŸŒ‰ èˆŠé‡‘å±±</button>
                <button onclick="filterAttractions('Yosemite')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-white text-gray-600 border border-gray-200 hover:bg-green-50 hover:text-green-600 transition-colors" data-filter="Yosemite">ğŸŒ² å„ªå‹ç¾åœ°</button>
                <button onclick="filterAttractions('PCH')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-white text-gray-600 border border-gray-200 hover:bg-yellow-50 hover:text-yellow-600 transition-colors" data-filter="PCH">ğŸŒŠ ä¸€è™Ÿå…¬è·¯</button>
                <button onclick="filterAttractions('LA')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-white text-gray-600 border border-gray-200 hover:bg-purple-50 hover:text-purple-600 transition-colors" data-filter="LA">ğŸ¬ æ´›æ‰ç£¯</button>
            </div>

            <!-- Grid -->
            <div id="attraction-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Content injected via JS -->
            </div>
        </section>

    </main>

    <footer class="bg-gray-900 text-white py-12 mt-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-2xl mb-4">ğŸ‡ºğŸ‡¸</p>
            <p class="text-gray-400">ç¥æ‚¨çš„ 2026 ç¾è¥¿ä¹‹æ—…å……æ»¿ç¾å¥½å›æ†¶ï¼</p>
            <div class="mt-8 text-xs text-gray-600">
                Generated from Travel Booklet Source Data
            </div>
        </div>
    </footer>

    <script>
        // --- Phase æ•¸æ“š (ä¿æŒä¸è®Š) ---
        const itineraryData = {
            phase2: {
                title: "Phase 2: åŠ å·ä¸€è™Ÿå…¬è·¯",
                days: [
                    // PCH Day 1 (SF-Carmel)
                    { date: "3/3 (äºŒ)", loc: "PCH Day 1 (SFâœCarmel)", act: "ä¸€è™Ÿå…¬è·¯ç¶“å…¸æµ·å²¸ç·š (200km)", detail: "ä¸Šåˆï¼šé£¯åº—é€€æˆ¿ã€å¸‚å€å–è»Šã€‚å•Ÿç¨‹æ²¿è‘— 1 è™Ÿå…¬è·¯å—ä¸‹ã€‚**è‡ªé§•è·¯æ³é‡é»ï¼šå‡ºç™¼å‰å‹™å¿…ç¢ºèª Caltrans è·¯æ³ä»¥é˜²åæ–¹ã€‚<BR>è·¯ç·šï¼šèˆŠé‡‘å±± â†’ åŠæœˆç£ â†’ è–å¡”å…‹é­¯èŒ² â†’ è’™ç‰¹ç‘ â†’ 17-Mile Drive â†’ å¡æ¢…çˆ¾å°é® (ç´„200KM)ã€‚<BR>æ™šä¸Šï¼šå…¥ä½å¡æ¢…çˆ¾/è’™ç‰¹é›·å€åŸŸé£¯åº—ã€‚", transport: "ğŸš— ç§Ÿè»Š/è‡ªé§• (å‹™å¿…åœ¨å¸‚å€å–è»Š)ã€‚", attractionKey: "å¡æ¢…çˆ¾å°é®", hotel: "éš†æ©æ©¡æœ¨é…’åº— (Lone Oak Inn)" },
                    // PCH Day 2 (Carmel-Morro Bay) 
                    { date: "3/4 (ä¸‰)", loc: "PCH Day 2 (CarmelâœMorro Bay)", act: "Big Sur å·¨å²©æµ·å²¸å¥‡æ™¯èˆ‡å¤å ¡", detail: "ä¸Šåˆï¼š**ç¬¬ä¸€ç«™ï¼šç¾…ä¼¯æ–¯è§’å·ç«‹è‡ªç„¶ä¿è­·å€** å¥è¡Œè³æµ·çºã€‚**ç¬¬äºŒç«™ï¼šæ¯”å…‹æ–¯æ¯”å¤§æ©‹** æ‹ç…§ã€‚é€”ç¶“ï¼š**è²ä½›æµ·ç˜** (ç´«è‰²æ²™ç˜ï¼Œå¯é¸æ“‡åœç•™)ã€‚**ç¬¬ä¸‰ç«™ï¼šéº¥å…‹å¨ç€‘å¸ƒ** è§€æ™¯å°ã€‚ä¸‹åˆï¼š**ç¬¬å››ç«™ï¼šèµ«æ°å¤å ¡** (éœ€é ç´„å°è¦½) åƒè§€ã€‚**ç¬¬äº”ç«™ï¼šè±¡é¼»æµ·è±¹ç˜** è§€è³æµ·è±¹ç¾¤ã€‚æ™šä¸Šï¼šæŠµé”ä¸¦å…¥ä½ Morro Bay é£¯åº—ã€‚", transport: "ğŸš— è‡ªé§• (å‹™å¿…ç¢ºèª Hwy 1 è·¯æ³ Caltrans)ã€‚", attractionKey: "èµ«æ°å¤å ¡ Hearst Castle", hotel: "æµ·æ¸¯å±‹é…’åº— (Harbor House Inn)" },
                    // PCH Day 3 (Morro Bay-LA) 
                    { date: "3/5 (å››)", loc: "PCH Day 3 (Morro BayâœLA)", act: "ç«¥è©±å°é®ã€è¥¿ç­ç‰™æµ·å²¸èˆ‡ 66 è™Ÿå…¬è·¯çµ‚é»", detail: "ä¸Šåˆï¼šé£¯åº—é€€æˆ¿ã€‚åœ¨ Pismo Beach é™„è¿‘äº«ç”¨æ—©é¤ã€‚**ç¬¬ä¸€ç«™ (å…§é™¸)ï¼šä¸¹éº¥æ‘ Solvang** (1.5 å°æ™‚) åƒè§€é¢¨è»Šã€å“åšä¸¹éº¥ç”œé»ã€‚**ç¬¬äºŒç«™ (æµ·å²¸)ï¼šè–å¡”èŠ­èŠ­æ‹‰** (2 å°æ™‚) ç™»é ‚æ³•é™¢é˜æ¨“ï¼Œä¸¦åœ¨ç¢¼é ­é™„è¿‘åˆé¤ã€‚ä¸‹åˆï¼šæ²¿æµ·å²¸ç·šå—ä¸‹ã€‚æ™šä¸Šï¼šæŠµé”æ´›æ‰ç£¯ï¼Œå‰å¾€ **è–å¡”è«å°¼å¡ç¢¼é ­** (Route 66 çµ‚é») è³å¤•é™½èˆ‡æ™šé¤ï¼Œå…¥ä½é£¯åº—ã€‚", transport: "ğŸš— è‡ªé§• (é€²å…¥æ´›æ‰ç£¯å‰äº¤é€šæœƒæ˜é¡¯è®Šæ…¢ï¼Œè«‹é ç•™ç·©è¡æ™‚é–“)ã€‚", attractionKey: "è–å¡”è«å°¼å¡ç¢¼é ­ Santa Monica Pier", hotel: "The Hollywood Franklin Hotel near Universal Studios" }
                ]
            },
            phase3: {
                title: "Phase 3: å¤©ä½¿ä¹‹åŸèˆ‡é›™æ¨‚åœ’",
                days: [
                    { date: "3/6 (äº”)", loc: "æ´›æ‰ç£¯", act: "é­”æ³•ç«¥è©±åœ‹åº¦ (è¿ªå£«å°¼)", detail: "ä¸Šåˆï¼šé£¯åº—é€€æˆ¿ã€é§•è»Šå‰å¾€ Anaheimã€è¿ªå£«å°¼æ¨‚åœ’ (Disneyland Park)ã€‚ä¸‹åˆï¼šè¿ªå£«å°¼æ¨‚åœ’ (California Adventure) éŠç©ã€‚æ™šä¸Šï¼šé§•è»Šè‡³ The Hollywood Franklin Hotel ä½å®¿ã€‚", transport: "ğŸš— è‡ªé§•ï¼š Santa Monica âœ Anaheim âœ Hollywoodã€‚", attractionKey: "è¿ªå£«å°¼æ¨‚åœ’", hotel: "The Hollywood Franklin Hotel" },
                    { date: "3/7 (å…­)", loc: "æ´›æ‰ç£¯", act: "å¥½èŠå¡¢æ™‚å°šæ¢ç´¢ (é‚„è»Š)", detail: "ä¸Šåˆï¼šé§•è»Šå‰å¾€ **æ ¼é‡Œæ–æ–¯å¤©æ–‡å° Griffith Observatory** (è§€æ™¯/æ‹ç…§)ã€‚ä¸‹åˆï¼š**å¥½èŠå¡¢æ˜Ÿå…‰å¤§é“** å°‹æ‰¾æ˜Ÿæ˜Ÿã€The Grove è³¼ç‰©ã€å‚æ™šé‚„è»Šã€‚æ™šä¸Šï¼šUber/Lyft å›é£¯åº—ã€‚", transport: "ğŸš— è‡ªé§• (éœ€æ”¯ä»˜ Griffith åœè»Šè²»æˆ–æ­æ¥é§è»Š) -> å‚æ™šé‚„è»Šã€‚é‚„è»Šå¾Œï¼š äº¤é€šæ”¹ç‚º Uber/Lyftã€‚", attractionKey: "æ ¼é‡Œæ–æ–¯å¤©æ–‡å° Griffith Observatory", hotel: "The Hollywood Franklin Hotel" },
                    { date: "3/8 (æ—¥)", loc: "æ´›æ‰ç£¯", act: "é›»å½±ç‰¹æ•ˆéœ‡æ’¼ (ç’°çƒå½±åŸ)", detail: "ä¸Šåˆï¼šå‰å¾€ **å¥½èŠå¡¢ç’°çƒå½±åŸ** å…¥åœ’ã€‚å¿…ç©ï¼šè¶…ç´šä»»å¤©å ‚ä¸–ç•Œã€Studio Tourã€å“ˆåˆ©æ³¢ç‰¹ã€‚ä¸‹åˆï¼šæŒçºŒéŠç©åœ’å€è¨­æ–½ã€‚æ™šä¸Šï¼šCityWalk ç”¨é¤è³¼ç‰©ã€Uber/Lyft å›é£¯åº—ã€‚", transport: "ğŸš• Uber/Lyft (æœ€æ–¹ä¾¿çœæ™‚)ã€‚", attractionKey: "å¥½èŠå¡¢ç’°çƒå½±åŸ Universal Studios", hotel: "The Hollywood Franklin Hotel" },
                    { date: "3/9 (ä¸€)", loc: "æ´›æ‰ç£¯", act: "è¼•é¬†å‘Šåˆ¥èˆ‡å›ç¨‹", detail: "ä¸Šåˆï¼šé£¯åº—é€€æˆ¿ã€Santa Monica æµ·é‚Šè‡ªç”±æ´»å‹•æˆ–è³¼ç‰©ã€‚ä¸‹åˆï¼šSanta Monica åˆé¤ã€æº–å‚™å‰å¾€ LAX æ©Ÿå ´ã€‚æ™šä¸Šï¼šæŠµé” LAXã€è¾¦ç†ç™»æ©Ÿæ‰‹çºŒã€22:15 âœˆï¸ èµ·é£›ã€‚", transport: "é£¯åº— âœ Santa Monica âœ LAXï¼š Uber/Lyft (å‹™å¿…é ç•™ 1.5-2 å°æ™‚è»Šç¨‹)ã€‚" }
                ]
            }
        };
        
        // ã€æ–°å¢ã€‘é¡è‰²é…ç½®ç‰©ä»¶ï¼šçµ±ä¸€ç®¡ç†æ¯å€‹éšæ®µçš„æ¨£å¼ï¼Œä½¿ renderItinerary æ›´ç°¡æ½”
        const phaseColors = {
            phase1: { title: 'èˆŠé‡‘å±±', primary: 'bg-blue-500', pin: 'border-blue-400', lineColor: 'border-blue-300', locColor: 'text-blue-600', locBg: 'bg-blue-100' },
            phase2: { title: 'åŠ å·ä¸€è™Ÿå…¬è·¯', primary: 'bg-yellow-500', pin: 'border-yellow-500', lineColor: 'border-yellow-400', locColor: 'text-yellow-600', locBg: 'bg-yellow-100' },
            phase3: { title: 'æ´›æ‰ç£¯', primary: 'bg-purple-500', pin: 'border-purple-500', lineColor: 'border-purple-400', locColor: 'text-purple-600', locBg: 'bg-purple-100' }
        };
    
        // --- Core Functions ---
    
        function createAttractionMap() {
            attractionMap = attractions.reduce((map, item) => {
                map[item.name] = item;
                return map;
            }, {});
        }
        
        function weatherIcon(code) {
          if (code === 0) return "â˜€ï¸";
          if ([1, 2].includes(code)) return "ğŸŒ¤ï¸";
          if (code === 3) return "â˜ï¸";
          if ([45, 48].includes(code)) return "ğŸŒ«ï¸";
          if ([51, 53, 55, 61, 63, 65].includes(code)) return "ğŸŒ§ï¸";
          if ([71, 73, 75].includes(code)) return "â„ï¸";
          return "ğŸŒ¡ï¸";
        }
        
        function wearAdvice(maxTemp) {
          if (maxTemp >= 28) return "ğŸ‘• ç‚ç†±ï¼ŒçŸ­è¢–ç‚ºä¸»ï¼Œæ³¨æ„é˜²æ›¬";
          if (maxTemp >= 22) return "ğŸ§¥ èˆ’é©ï¼Œè–„é•·è¢–æˆ–è¥¯è¡«";
          if (maxTemp >= 16) return "ğŸ§¶ å¾®æ¶¼ï¼Œå»ºè­°è–„å¤–å¥—";
          return "ğŸ§£ åå†·ï¼Œå¤–å¥—æˆ–ä¿æš–å±¤";
        }
        
        // ã€å„ªåŒ–ã€‘åŠ å…¥ try...catch éŒ¯èª¤è™•ç†ï¼Œæå‡ç©©å®šæ€§
        async function fetch3DayWeather(lat, lon, containerId, wearId) {
            const container = document.getElementById(containerId);
            const wear = document.getElementById(wearId);
    
            try {
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=weathercode,temperature_2m_max,temperature_2m_min&forecast_days=3&timezone=auto`;
                const res = await fetch(url);
                
                if (!res.ok) {
                    throw new Error(`Weather API HTTP error! Status: ${res.status}`);
                }
                
                const data = await res.json();
                
                // æ¸…é™¤èˆŠå…§å®¹ä¸¦é–‹å§‹æ¸²æŸ“
                container.innerHTML = "";
                
                data.daily.time.forEach((date, i) => {
                    const card = document.createElement("div");
                    card.className = "weather-card";
                    
                    card.innerHTML = `
                         <div class="weather-icon">${weatherIcon(data.daily.weathercode[i])}</div>
                         <div class="weather-date">${new Date(date).toLocaleDateString()}</div>
                         <div class="weather-temp">
                           ${data.daily.temperature_2m_max[i]}Â° /
                           ${data.daily.temperature_2m_min[i]}Â°
                         </div>
                    `;
                    container.appendChild(card);
                });
                
                // æ¸²æŸ“ç©¿æ­å»ºè­°
                wear.innerText = wearAdvice(data.daily.temperature_2m_max[0]);
                
            } catch (error) {
                console.error("Weather fetch failed:", error);
                if(container) container.innerHTML = `<div class="p-3 bg-red-50 text-red-600 rounded-lg text-sm">âš ï¸ è¼‰å…¥å¤±æ•—</div>`;
                if(wear) wear.innerText = "å¤©æ°£è¼‰å…¥å¤±æ•—ï¼Œå»ºè­°å‚™å¦¥ä¿æš–è¡£ç‰©ã€‚";
            }
        }
        
        function loadCurrentLocationWeather() {
          if (!navigator.geolocation) {
            document.getElementById("current-city").innerText = "ç„¡æ³•å–å¾—å®šä½";
            return;
          }
        
          navigator.geolocation.getCurrentPosition(async pos => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
        
            document.getElementById("current-city").innerText = "ä¾ç›®å‰å®šä½";
        
            fetch3DayWeather(lat, lon, "weather-current", "wear-current");
          });
        }
    
        function init() {
            createAttractionMap(); // å‘¼å«æ–°çš„åœ°åœ–å‰µå»ºå‡½æ•¸
            renderFlightTable('outbound');
            renderAccommodation(); // æ¸²æŸ“ä½å®¿è³‡è¨Š
            renderWeatherChart();
            renderItinerary('phase2'); // é è¨­é¡¯ç¤º PCH éšæ®µ
            renderAttractions('all'); // é è¨­æ¸²æŸ“æ‰€æœ‰æ™¯é»
            loadCurrentLocationWeather(); 
            // San Francisco
            fetch3DayWeather(37.7749, -122.4194, "weather-sf", "wear-sf");
            
            // Los Angeles
            fetch3DayWeather(34.0522, -118.2437, "weather-la", "wear-la");
    
        }
    
        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }
    
        // --- Logistics Logic (Functions remain the same) ---
    
        function switchFlightTab(type) {
            document.getElementById('btn-outbound').classList.remove('bg-white', 'shadow', 'text-gray-900');
            document.getElementById('btn-inbound').classList.remove('bg-white', 'shadow', 'text-gray-900');
            document.getElementById('btn-outbound').classList.add('text-gray-500');
            document.getElementById('btn-inbound').classList.add('text-gray-500');
    
            const activeBtn = document.getElementById(`btn-${type}`);
            activeBtn.classList.remove('text-gray-500');
            activeBtn.classList.add('bg-white', 'shadow', 'text-gray-900');
    
            renderFlightTable(type);
        }
    
        function renderFlightTable(type) {
            // ... (Flight rendering logic remains the same)
            const data = flightData[type];
            const container = document.getElementById('flight-content');
            let html = '';
            
            data.forEach((flight, index) => {
                html += `
                    <div class="flex items-start p-3 bg-gray-50 rounded-lg">
                        <div class="flex-shrink-0 bg-blue-100 text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3 text-sm">
                            ${index + 1}
                        </div>
                        <div class="flex-grow">
                            <div class="flex items-center space-x-2 mb-1">
                                <span class="font-bold text-gray-800">${flight.leg}</span>
                                <span class="text-sm font-semibold text-blue-700 bg-blue-200 px-2 py-0.5 rounded-lg">åœ‹æ³° ${flight.number}</span>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-xs bg-gray-200 text-gray-600 px-2 py-0.5 rounded-full">${flight.note}</span>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-sm text-gray-600">
                                <div><span class="text-gray-400">èµ·é£›:</span> ${flight.date}</div>
                                <div><span class="text-gray-400">æŠµé”:</span> ${flight.arr}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
    
            // --- åœ‹æ³°èˆªç©ºå ±åˆ°è³‡è¨Š (Cathay Pacific Check-in) ---
            html += `
                <div class="mt-6 p-4 border border-teal-200 bg-teal-50 rounded-xl space-y-3">
                    <h4 class="text-base font-bold text-teal-800 flex items-center">
                        <span class="text-xl mr-2">ğŸ›„</span> åœ‹æ³°èˆªç©ºå ±åˆ°æŒ‡å¼• (Cathay Pacific)
                    </h4>
                    
                    <div>
                        <p class="text-sm font-semibold text-teal-900 mb-1">âœ… ç·šä¸Šå ±åˆ° (Online Check-in)</p>
                        <p class="text-xs text-teal-700">é–‹æ”¾æ™‚é–“ï¼šé€šå¸¸ç‚ºèµ·é£›å‰ 48 å°æ™‚ã€‚å»ºè­°å„ªå…ˆä½¿ç”¨ä»¥ç¯€çœæ™‚é–“ã€‚</p>
                        <a href="https://www.cathaypacific.com/mb/?cxsource=TOP-NAV_FLIGHTS_3_1#!/zh_TW/olci/login" target="_blank" class="text-xs text-blue-600 hover:underline font-medium inline-flex items-center">
                            å‰å¾€åœ‹æ³°èˆªç©ºå®˜ç¶²å ±åˆ°é€£çµ 
                            <svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
                        </a>
                    </div>
    
                    <div>
                        <p class="text-sm font-semibold text-teal-900 mb-1">ğŸ“ æ©Ÿå ´æ«ƒæª¯è³‡è¨Š (TPE)</p>
                        <p class="text-xs text-teal-700">åœ°é»ï¼šæ¡ƒåœ’æ©Ÿå ´ç¬¬äºŒèˆªå»ˆã€‚åœ‹æ³°æ«ƒæª¯é€šå¸¸ä½æ–¼ **D æˆ– E å€**ã€‚</p>
                        <p class="text-xs text-red-700 font-bold mt-1">
                            *è«‹å‹™å¿…è‡³å°‘æå‰ 2 å°æ™‚æŠµé”ï¼Œä¸¦ä»¥ç•¶æ—¥æ©Ÿå ´ FIDS è¢å¹•è³‡è¨Šç‚ºæº–ã€‚
                        </p>
                    </div>
                </div>
            `;
            // --- çµæŸåœ‹æ³°èˆªç©ºå ±åˆ°è³‡è¨Š ---
            container.innerHTML = html;
        }
    
        // æ¸²æŸ“ä½å®¿è³‡è¨Š
        function renderAccommodation() {
            // ... (Accommodation rendering logic remains the same)
            const container = document.getElementById('accommodation-content');
            
            // Convert object to array for easy iteration
            const accommodations = Object.values(accommodationData);
    
            let html = '';
            accommodations.forEach((hotel) => {
                let colorClass = '';
                if (hotel.city.includes('èˆŠé‡‘å±±')) colorClass = 'border-blue-500 bg-blue-50 text-blue-800';
                else if (hotel.city.includes('PCH')) colorClass = 'border-yellow-500 bg-yellow-50 text-yellow-800';
                else colorClass = 'border-purple-500 bg-purple-50 text-purple-800';
    
                html += `
                    <div class="p-4 rounded-xl border-l-4 ${colorClass} shadow-inner">
                        <h4 class="text-base font-bold mb-1">
                            ${hotel.city} <span class="text-sm font-medium">(${hotel.dates})</span>
                        </h4>
                        <p class="text-sm font-semibold mb-1">${hotel.name}</p>
                        <p class="text-xs italic">ğŸ“ åœ°å€: ${hotel.address}</p>
                        <a href="${hotel.mapLink !== '#' ? hotel.mapLink : 'javascript:void(0)'}" target="_blank" class="text-xs font-medium ${hotel.mapLink !== '#' ? 'text-gray-700 hover:underline' : 'text-gray-400 cursor-default'} inline-flex items-center mt-2">
                            ${hotel.mapLink !== '#' ? 'æŸ¥çœ‹åœ°åœ–' : 'åœ°åœ–é€£çµå¾…è£œ'}
                            <svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
                        </a>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
    
        function renderWeatherChart() {
            // ... (Chart logic remains the same)
            const ctx = document.getElementById('weatherChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['æ—©æ™¨', 'ä¸­åˆ', 'å‚æ™š', 'å¤œæ™š'],
                    datasets: [
                        {
                            label: 'èˆŠé‡‘å±± (SF) æ°£æº« Â°C',
                            data: [8, 14, 12, 9],
                            borderColor: '#4299e1', // Ocean Blue
                            backgroundColor: 'rgba(66, 153, 225, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'æ´›æ‰ç£¯ (LA) æ°£æº« Â°C',
                            data: [11, 21, 18, 12],
                            borderColor: '#ed8936', // Warm Orange
                            backgroundColor: 'rgba(237, 137, 54, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 0,
                            max: 25,
                            title: { display: true, text: 'æº«åº¦ (Â°C)' }
                        }
                    }
                }
            });
        }
    
        // --- Itinerary Logic ---
    
        // ã€å„ªåŒ–ã€‘ä¿®æ”¹åœ°åœ– URL ç”Ÿæˆï¼šPCH ä½¿ç”¨è·¯ç·šæ¨¡å¼ï¼ŒåŸå¸‚ä½¿ç”¨æœå°‹æ¨¡å¼ï¼Œæå‡å¯¦ç”¨æ€§
        function generatePhaseMapUrl(phaseKey) {
            let poiList = [];
    
            if (phaseKey === 'phase1') {
                // èˆŠé‡‘å±±ï¼šä½å®¿ + é—œéµæ™¯é»
                poiList = [
                    "Riu Plaza Fisherman's Wharf, San Francisco", 
                    "Alcatraz Island, San Francisco", 
                    "Golden Gate Bridge, San Francisco", 
                    "Lombard Street, San Francisco",
                    "Ferry Building Marketplace, San Francisco", 
                    "Chase Center, San Francisco"
                ];
            } else if (phaseKey === 'phase2') {
                // ä¸€è™Ÿå…¬è·¯ (é•·è·é›¢)ï¼šä½¿ç”¨è·¯ç·šæ¨¡å¼ (Directions)
                const route = ["San Francisco", "Carmel-by-the-Sea", "Morro Bay, CA", "Santa Monica Pier, Los Angeles"];
                const start = route[0];
                const end = route[route.length - 1];
                // ä¸­é–“é»ä½œç‚ºé€”ç¶“é»
                const waypoints = route.slice(1, -1).join('|'); 
                
                // ä½¿ç”¨ Google Maps è·¯ç·šé€£çµ
                return `https://www.google.com/maps?q=36.5970385420236,-121.858062297105796{encodeURIComponent(start)}/${encodeURIComponent(end)}?waypoints=${encodeURIComponent(waypoints)}&travelmode=driving`;
    
            } else if (phaseKey === 'phase3') {
                // æ´›æ‰ç£¯ï¼šä½å®¿ + é—œéµæ™¯é»
                poiList = [
                    "The Hollywood Franklin Hotel, Los Angeles", 
                    "Santa Monica Pier", 
                    "Disneyland Park, Anaheim", 
                    "Universal Studios Hollywood", 
                    "Griffith Observatory", 
                    "Hollywood Walk of Fame"
                ];
            }
            
            // Phase 1 and Phase 3 uses search mode
            const query = poiList.join(' and '); 
            return `https://www.google.com/maps?q=36.5970385420236,-121.858062297105797{encodeURIComponent(query)}`;
        }
    
        // æ™¯é»å¾½ç« é¡è‰²å·¥å…·å‡½æ•¸ 
        function getAttractionBadgeColor(type) {
            if (type === 'History') return 'bg-amber-100 text-amber-800';
            if (type === 'Nature') return 'bg-green-100 text-green-800';
            if (type === 'Fun') return 'bg-pink-100 text-pink-800';
            if (type === 'Food') return 'bg-orange-100 text-orange-800';
            if (type === 'Photo') return 'bg-red-100 text-red-800'; 
            if (type === 'Culture') return 'bg-teal-100 text-teal-800'; 
            return 'bg-gray-100 text-gray-600';
        }
    
        function renderItinerary(phaseKey) {
            // Update active sidebar style
            ['phase1', 'phase2', 'phase3'].forEach(key => {
                const btn = document.getElementById(`nav-${key}`);
                // Clear all styles first
                btn.classList.remove('bg-white', 'shadow-sm', 'border-blue-500', 'border-yellow-500', 'border-purple-500', 'hover:border-yellow-500', 'hover:bg-yellow-50', 'hover:border-purple-500', 'hover:bg-purple-50', 'bg-blue-50', 'bg-yellow-50', 'bg-purple-50');
                
                // Add default non-active styles
                btn.classList.add('border-transparent', 'bg-gray-50');
                
                // Set hover styles based on phase
                if (key === 'phase2') btn.classList.add('hover:border-yellow-500', 'hover:bg-yellow-50');
                if (key === 'phase3') btn.classList.add('hover:border-purple-500', 'hover:bg-purple-50');
                if (key === 'phase1') btn.classList.add('hover:border-blue-500', 'hover:bg-blue-50');
    
                
                // Apply active style
                if (key === phaseKey) {
                    btn.classList.add('bg-white', 'shadow-sm');
                    btn.classList.remove('border-transparent', 'bg-gray-50');
                    if (key === 'phase1') btn.classList.add('border-blue-500', 'bg-blue-50');
                    if (key === 'phase2') btn.classList.add('border-yellow-500', 'bg-yellow-50');
                    if (key === 'phase3') btn.classList.add('border-purple-500', 'bg-purple-50');
                }
            });
    
            const phase = itineraryData[phaseKey];
            const container = document.getElementById('itinerary-details');
            const mapUrl = generatePhaseMapUrl(phaseKey); // Get the map URL
    
            // ã€å„ªåŒ–ã€‘ä½¿ç”¨ phaseColors å–å¾—æ¨£å¼
            const colors = phaseColors[phaseKey];
            const primaryColorClass = colors.primary;
            const hoverColorClass = colors.primary.replace('-500', '-600'); 
            const { pinColor, lineColor, locColor, locBg } = colors;
    
            // Generate HTML with animation
            let html = `
                <div class="mb-6 animate-fade-in">
                    <a href="${mapUrl}" target="_blank" class="flex items-center justify-center p-3 mb-4 rounded-xl text-white font-bold ${primaryColorClass} ${hoverColorClass} transition-colors shadow-lg card-hover">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0L6.343 16.657A8 8 0 1117.657 16.657z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        ğŸ” åœ°åœ–é€£çµ: é»æ“ŠæŸ¥çœ‹ ${phase.title} å€åŸŸæ‰€æœ‰æ™¯é» / è·¯ç·š
                        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
                    </a>
                    
                    <h3 class="text-2xl font-bold text-gray-900">${phase.title}</h3>
                    <div class="h-1 w-20 ${primaryColorClass.replace('bg-', 'bg-')} mt-2 rounded-full"></div>
                </div>
            `;
    
            phase.days.forEach(day => {
                // Check for linked attraction
                const attraction = day.attractionKey ? attractionMap[day.attractionKey] : null;
                let attractionHtml = '';
    
                if (attraction) {
                    const badgeColor = getAttractionBadgeColor(attraction.type);
                    const typeLabel = attraction.type === 'History' ? 'æ­·å²åœ°æ¨™' : 
                                      attraction.type === 'Nature' ? 'è‡ªç„¶æ™¯è§€' : 
                                      attraction.type === 'Fun' ? 'å¨›æ¨‚æ¨‚åœ’' : 
                                      attraction.type === 'Food' ? 'ç¾é£Ÿé«”é©—' : 
                                      attraction.type === 'Photo' ? 'æ”å½±æ‰“å¡' : 
                                      attraction.type === 'Culture' ? 'æ–‡åŒ–è—è¡“' : 'å…¶ä»–';
    
                    attractionHtml = `
                        <div class="mt-3 pt-3 border-t border-gray-100">
                            <div class="flex items-center space-x-2 mb-2">
                                <div class="text-xl">${attraction.icon}</div>
                                <button onclick="scrollToSection('highlights')" class="text-sm font-bold text-gray-800 underline hover:text-yellow-600 attraction-link cursor-pointer p-0 m-0 border-none bg-transparent flex items-center">
                                    <span class="mr-1">æ™¯é»äº®é»:</span>
                                    <span>${attraction.name}</span>
                                </button>
                                <span class="text-xs px-2 py-0.5 rounded-full font-bold ${badgeColor}">${typeLabel}</span>
                            </div>
                            <p class="text-xs text-gray-600 italic leading-relaxed">${attraction.short_desc}</p>
                        </div>
                    `;
                }
    
                // Check for linked hotel
                let hotelHtml = '';
                const currentHotel = Object.values(accommodationData).find(h => h.name === day.hotel);
                if (currentHotel) {
                       hotelHtml = `<span class="text-xs text-gray-500 bg-yellow-50 border border-yellow-200 inline-block px-2 py-1 rounded ml-2">ğŸ  ${currentHotel.city}</span>`;
                }
                
                // ã€å„ªåŒ–ã€‘è™•ç† day.detail å…§å®¹ï¼Œå°‡ <BR> è½‰ç‚ºæ›è¡Œï¼Œå°‡ **ç²—é«”** è½‰ç‚ºé«˜äº®é¡è‰²
                let processedDetail = day.detail;
                processedDetail = processedDetail.replace(/<BR>/g, '<br>');
                // ä½¿ç”¨ç•¶å‰ Phase çš„ locColor é¡è‰²é¡åˆ¥ä¾†çªå‡ºç²—é«”å­—
                processedDetail = processedDetail.replace(/\*\*(.*?)\*\*/g, `<span class="font-bold ${locColor}">$1</span>`); 
    
    
                html += `
                    <div class="flex group relative pl-8 pb-8 last:pb-0 border-l-2 border-gray-200 last:border-0 hover:${lineColor} transition-colors">
                        <div class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-white border-4 ${pinColor} group-hover:scale-125 transition-transform"></div>
                        <div class="bg-gray-50 rounded-xl p-5 w-full hover:bg-white hover:shadow-md transition-all border border-gray-100">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-2">
                                <span class="font-bold ${locColor} ${locBg} px-3 py-1 rounded-full text-sm w-fit mb-2 sm:mb-0">
                                    ${day.date}
                                    ${hotelHtml}
                                </span>
                                <span class="text-sm font-semibold text-gray-500 flex items-center">
                                    <span class="mr-1">ğŸ“</span> ${day.loc}
                                </span>
                            </div>
                            <h4 class="text-lg font-bold text-gray-800 mb-2">${day.act}</h4>
                            
                            <p class="text-gray-600 text-sm leading-relaxed mb-1">${processedDetail}</p>
                            
                            ${attractionHtml} <div class="text-xs text-gray-500 bg-white border border-gray-200 inline-block px-2 py-1 rounded mt-3">
                                ğŸš‡ äº¤é€š: ${day.transport}
                            </div>
                        </div>
                    </div>
                `;
            });
    
            container.innerHTML = html;
        }
    
        // --- Attraction Logic (ä¿æŒä¸è®Š) ---
    
        function filterAttractions(filter) {
            // Update active button state
            document.querySelectorAll('.filter-btn').forEach(btn => {
                // Remove all color classes
                btn.classList.remove('bg-gray-800', 'text-white', 'shadow-md');
                btn.classList.remove('bg-white', 'text-gray-600', 'border', 'hover:bg-blue-50', 'hover:text-blue-600', 'hover:bg-yellow-50', 'hover:text-yellow-600', 'hover:bg-purple-50', 'hover:text-purple-600', 'hover:bg-green-50', 'hover:text-green-600');
                
                // Add default non-active styles
                btn.classList.add('bg-white', 'text-gray-600', 'border', 'border-gray-200');
    
                if(btn.dataset.filter === filter) {
                    // Active state
                    btn.classList.add('bg-gray-800', 'text-white', 'shadow-md');
                    btn.classList.remove('bg-white', 'text-gray-600', 'border', 'border-gray-200');
                } else {
                    // Hover states based on filter name (for non-active buttons)
                    if (btn.dataset.filter === 'SF') btn.classList.add('hover:bg-blue-50', 'hover:text-blue-600');
                    if (btn.dataset.filter === 'Yosemite') btn.classList.add('hover:bg-green-50', 'hover:text-green-600');
                    if (btn.dataset.filter === 'PCH') btn.classList.add('hover:bg-yellow-50', 'hover:text-yellow-600');
                    if (btn.dataset.filter === 'LA') btn.classList.add('hover:bg-purple-50', 'hover:text-purple-600');
                }
            });
    
            renderAttractions(filter);
        }
    
        function renderAttractions(filter) {
            const container = document.getElementById('attraction-grid');
            
            // Filter only by the city/area code (SF, PCH, LA)
            const filtered = filter === 'all' 
                ? attractions 
                : attractions.filter(a => a.city === filter);
            
            let html = '';
            if (filtered.length === 0) {
                html = '<p class="col-span-full text-center text-gray-500 p-8">æ­¤éšæ®µå°šç„¡æ™¯é»è³‡è¨Šï¼Œè«‹æŸ¥çœ‹å…¶ä»–å€åŸŸã€‚</p>';
            } else {
                filtered.forEach(item => {
                    // ä½¿ç”¨å…±ç”¨å‡½æ•¸ç²å–é¡è‰² (ç”¨æ–¼å¡ç‰‡é ‚éƒ¨çš„é¡å‹å¾½ç« )
                    const badgeColor = getAttractionBadgeColor(item.type);
                    const typeLabel = item.type === 'History' ? 'æ­·å²åœ°æ¨™' : 
                                        item.type === 'Nature' ? 'è‡ªç„¶æ™¯è§€' : 
                                        item.type === 'Fun' ? 'å¨›æ¨‚æ¨‚åœ’' : 
                                        item.type === 'Food' ? 'ç¾é£Ÿé«”é©—' : 
                                        item.type === 'Photo' ? 'æ”å½±æ‰“å¡' : 
                                        item.type === 'Culture' ? 'æ–‡åŒ–è—è¡“' : 'å…¶ä»–';
    
                    // åŸå¸‚åç¨±è½‰æ›
                    const cityLabel = item.city === 'SF' ? 'èˆŠé‡‘å±±' : item.city === 'LA' ? 'æ´›æ‰ç£¯' : item.city === 'Yosemite' ? 'å„ªå‹ç¾åœ°' : 'ä¸€è™Ÿå…¬è·¯';
    
                    // åŸå¸‚é¡è‰²æ¨™ç±¤
                    let areaBadgeClass = 'bg-gray-100 text-gray-600';
                    if (item.city === 'SF') areaBadgeClass = 'bg-blue-100 text-blue-800';
                    else if (item.city === 'PCH') areaBadgeClass = 'bg-yellow-100 text-yellow-800';
                    else if (item.city === 'LA') areaBadgeClass = 'bg-purple-100 text-purple-800';
                    else if (item.city === 'Yosemite') areaBadgeClass = 'bg-green-100 text-green-800';
    
                    // å°‡å¡ç‰‡å®¹å™¨å¾ div æ”¹ç‚º <a> æ¨™ç±¤ï¼Œä¸¦è¨­å®š href å’Œ target="_blank"
                    html += `
                        <a href="${item.url}" target="_blank" rel="noopener noreferrer" 
                            class="bg-white rounded-xl shadow-sm border border-gray-100 p-5 card-hover flex flex-col h-full group block cursor-pointer"
                            aria-label="å‰å¾€ ${item.name} å®˜æ–¹ç¶²ç«™">
                            
                            <div class="flex justify-between items-start mb-3">
                                <div class="text-4xl">${item.icon}</div>
                                <div class="flex space-x-2">
                                    <span class="text-xs px-2 py-1 rounded-full font-bold ${badgeColor}">${typeLabel}</span>
                                    <span class="text-xs px-2 py-1 rounded-full font-bold ${areaBadgeClass}">${cityLabel}</span>
                                </div>
                            </div>
                            <h4 class="text-lg font-bold text-gray-900 mb-1">${item.name}</h4>
                            <p class="text-sm text-gray-600 flex-grow mt-2">${item.desc}</p>
                            
                            <div class="mt-4 pt-3 border-t border-gray-100 flex justify-between items-center">
                                <span class="text-sm font-semibold text-indigo-600 group-hover:text-indigo-800 transition-colors">
                                    äº†è§£æ›´å¤š (å®˜æ–¹ç¶²ç«™)
                                </span>
                                <svg class="w-4 h-4 text-indigo-500 group-hover:translate-x-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                                </svg>
                            </div>
                        </a>
                    `;
                });
            }
            container.innerHTML = html;
        }
    
        // Initialize App
        window.addEventListener('DOMContentLoaded', init);
    
    </script>
</body>
</html>
